"""
Created on Sun Jun 18 13:32:45 2023

@author: lakshya
"""
import json

def create_vulnerability_database():
    # Define the path to your CVE JSON file
    file_path = 'nvdcve-1.1-2023.json'

    # Load the CVE JSON file
    with open(file_path, 'r', encoding='utf-8') as f:
        data = json.load(f)
        
    # Process each CVE item
    for item in data['CVE_Items']:
        # Extract the CVE ID
        cve_id = item['cve']['CVE_data_meta']['ID']

        # Check if 'description_data' list is not empty before accessing its elements
        if item['cve']['description']['description_data']:
            description = item['cve']['description']['description_data'][0]['value']
        else:
            description = ''

        # Process each node in the configurations
        for node in item['configurations']['nodes']:
            if 'cpe_match' in node:
                for cpe in node['cpe_match']:
                    if 'cpe23Uri' in cpe and cpe['vulnerable']:
                        parts = cpe['cpe23Uri'].split(':')
                        if len(parts) >= 6:
                            service_name = parts[3]
                            version = parts[5]

                            print(f"Service: {service_name}, Version: {version}, CVE ID: {cve_id}, Description: {description}")

create_vulnerability_database()
